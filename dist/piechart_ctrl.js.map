{"version":3,"sources":["../src/piechart_ctrl.js"],"names":[],"mappings":"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","file":"piechart_ctrl.js","sourcesContent":["import {MetricsPanelCtrl} from 'app/plugins/sdk';\nimport _ from 'lodash';\nimport $ from 'jquery';\nimport kbn from 'app/core/utils/kbn';\nimport TimeSeries from 'app/core/time_series';\nimport rendering from './rendering';\nimport legend from './legend';\n\nimport coreModule from 'app/core/core_module';\n\nimport Tether from 'tether';\n\n// Assigned as a global due to bs-typeahead angularjs problems\nvar _bs;\n\nexport class PieChartCtrl extends MetricsPanelCtrl {\n  constructor($scope, $injector, $rootScope, $compile, backendSrv, linkSrv) {\n    super($scope, $injector);\n\n    this.$rootScope = $rootScope;\n    this.linkSrv = linkSrv;\n    this.backendSrv = backendSrv;\n    this.$scope = $scope;\n    this.$compile = $compile;\n\n    _bs = backendSrv;\n\n    var panelDefaults = {\n      pieType: 'pie',\n      legend: {\n\t// disable/enable legend\n        show: true,\n        values: true\n      },\n      links: [],\n      datasource: null,\n      maxDataPoints: 3,\n      interval: null,\n      targets: [{}],\n      cacheTimeout: null,\n      nullPointMode: 'connected',\n      legendType: 'Under graph',\n      aliasColors: {},\n      format: 'short',\n      valueName: 'current',\n      strokeWidth: 1,\n      fontSize: '80%',\n\n      clickable: false,\n      cevents: [],\n\n      mappingTypes: [\n        {name: 'Value to Text', value: 1},\n        {name: 'Range to Text', value: 2},\n      ],\n      mappingType: 1,\n      mappingDataTypes: [\n        {name: 'Numeric', value: 1},\n        {name: 'String', value: 2},\n        {name: 'IP address', value: 3},\n      ],\n      mappingDataType: 1,\n      valueMaps: [\n        { value: 'null', op: '=', text: 'N/A' }\n      ],\n      rangeMaps: [\n        { from: 'null', to: 'null', text: 'N/A' }\n      ],\n\n      mappingHelpIndex: null,\n    };\n\n    coreModule.filter('startFrom', function() {\n      return function(input, start) {\n        start = +start;\n        return input.slice(start);\n      };\n    });\n    this.currentValuePage = 0;\n    this.currentRangePage = 0;\n    this.pageSize = 10;\n\n    _.defaults(this.panel, panelDefaults);\n    _.defaults(this.panel.legend, panelDefaults.legend);\n\n    this.events.on('render', this.onRender.bind(this));\n    this.events.on('data-received', this.onDataReceived.bind(this));\n    this.events.on('data-error', this.onDataError.bind(this));\n    this.events.on('data-snapshot-load', this.onDataReceived.bind(this));\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n  }\n\n  numberOfPages(isRange) {\n    return Math.floor(((isRange)?this.panel.rangeMaps.length:this.panel.valueMaps.length)/this.pageSize);\n  } \n\n  onInitEditMode() {\n    this.addEditorTab('Options', 'public/plugins/grafana-piechart-panel/editor.html', 2);\n    this.addEditorTab('Value Mappings', 'public/plugins/grafana-piechart-panel/mappings.html', 3);\n    this.addEditorTab('Events', 'public/plugins/grafana-piechart-panel/events.html', 4);\n    this.unitFormats = kbn.getUnitFormats();\n  }\n\n  setUnitFormat(subItem) {\n    this.panel.format = subItem.value;\n    this.render();\n  }\n\n  onDataError() {\n    this.series = [];\n    this.render();\n  }\n\n  changeSeriesColor(series, color) {\n    series.color = color;\n    this.panel.aliasColors[series.alias] = series.color;\n    this.render();\n  }\n\n  onRender() {\n    this.data = this.parseSeries(this.series);\n  }\n\n  parseSeries(series) {\n    return _.map(this.series, (serie, i) => {\n      return {\n        label: serie.alias,\n        data: serie.stats[this.panel.valueName],\n        color: this.panel.aliasColors[serie.alias] || this.$rootScope.colors[i]\n      };\n    });\n  }\n\n  onDataReceived(dataList) {\n    this.series = dataList.map(this.seriesHandler.bind(this));\n    this.data = this.parseSeries(this.series);\n    this.render(this.data);\n  }\n\n  seriesHandler(seriesData) {\n    var series = new TimeSeries({\n      datapoints: seriesData.datapoints,\n      alias: seriesData.target\n    });\n\n    series.flotpairs = series.getFlotPairs(this.panel.nullPointMode);\n    return series;\n  }\n\n  getDecimalsForValue(value) {\n    if (_.isNumber(this.panel.decimals)) {\n      return { decimals: this.panel.decimals, scaledDecimals: null };\n    }\n\n    var delta = value / 2;\n    var dec = -Math.floor(Math.log(delta) / Math.LN10);\n\n    var magn = Math.pow(10, -dec);\n    var norm = delta / magn; // norm is between 1.0 and 10.0\n    var size;\n\n    if (norm < 1.5) {\n      size = 1;\n    } else if (norm < 3) {\n      size = 2;\n      // special case for 2.5, requires an extra decimal\n      if (norm > 2.25) {\n        size = 2.5;\n        ++dec;\n      }\n    } else if (norm < 7.5) {\n      size = 5;\n    } else {\n      size = 10;\n    }\n\n    size *= magn;\n\n    // reduce starting decimals if not needed\n    if (Math.floor(value) === value) { dec = 0; }\n\n    var result = {};\n    result.decimals = Math.max(0, dec);\n    result.scaledDecimals = result.decimals - Math.floor(Math.log(size) / Math.LN10) + 2;\n\n    return result;\n  }\n\n  formatValue(value) {\n    var decimalInfo = this.getDecimalsForValue(value);\n    var formatFunc = kbn.valueFormats[this.panel.format];\n    if (formatFunc) {\n      return formatFunc(value, decimalInfo.decimals, decimalInfo.scaledDecimals);\n    }\n    return value;\n  }\n\n  link(scope, elem, attrs, ctrl) {\n    rendering(scope, elem, attrs, ctrl);\n  }\n\n  searchDashboards(queryStr, callback) {\n    var elem = (this === null || typeof this === undefined) ? _bs : this.backendSrv;\n    elem.search({query: queryStr}).then(function(hits) {\n      var dashboards = _.map(hits, function(dash) {\n        return dash.title;\n      });\n\n      callback(dashboards);\n    });\n  }\n\n  dashboardChanged(link) {\n    var elem = (this === null || typeof this === undefined) ? _bs : this.backendSrv;\n    elem.search({query: link.dashboard}).then(function(hits) {\n      var dashboard = _.findWhere(hits, {title: link.dashboard});\n      if (dashboard) {\n        link.dashUri = dashboard.uri;\n        link.title = dashboard.title;\n      }\n    });\n\n    this.refresh();\n  }\n\n  deleteLink(link) {\n    this.panel.cevents = _.without(this.panel.cevents, link);\n  }\n\n  addLink() {\n    this.panel.cevents.push({\n      type: 'dashboard',\n    });\n  }\n\n  removeMap(map, isRange) {\n    var index = _.indexOf((isRange)?this.panel.rangeMaps:this.panel.valueMaps, map);\n    if (isRange) {\n      this.panel.rangeMaps.slice(index, 1);\n    } else {\n      this.panel.valueMaps.splice(index, 1);\n    }\n    this.render();\n  }\n\n  addMap(isRange) {\n    if (isRange) {\n      this.panel.rangeMaps.push({from: '', to: '', text: ''});\n    } else {\n      this.panel.valueMaps.push({value: '', op: '=', text: ''});\n    }\n  }\n  \n  cleanMapList(isRange) {\n    var l = (isRange)?this.panel.rangeMaps.length:this.panel.valueMaps.length;\n    for (var i=0; i<l; i++) {\n      if (isRange) {\n        this.panel.rangeMaps.splice(0,1);\n      } else {\n        this.panel.valueMaps.splice(0,1);\n      }\n    }\n    this.render();\n  }\n\n  cancelImportMapList(isRange) {\n    this.importContainer._reader.abort(); \n  }\n\n  importMapList(isRange) {\n    this.currentValuePage = 0;\n    this.currentRangePage = 0;\n\n    this.importContainer = document.createElement(\"input\");\n    this.importContainer.setAttribute(\"type\",\"file\");\n    this.importContainer.setAttribute(\"name\",\"files[]\");\n    this.importContainer.setAttribute(\"multiple\",\"\");\n    this.importContainer._controller = this;\n    this.importContainer.addEventListener('change', function(evt) {\n      var files = evt.target.files;\n      for (var i=0, f; f = files[i]; i++) {\n        // Only process csv files\n        if (!f.type.match(\".*csv\")) {\n          continue;\n        }\n        this._reader = new FileReader();\n        this._reader.onload = (function(_file, _input) {\n          return function(e) {\n            document.getElementById(\"import-loading\").setAttribute(\"style\",\"display: inline-block;\");\n            document.getElementById(\"import-button\").setAttribute(\"style\",\"display: none;\");\n            document.getElementById(\"cancel-import-button\").setAttribute(\"style\",\"display: inline-block;\");\n            var l = e.target.result.split(\"\\n\");\n            for (var i=0; i<l.length; i++) {\n              var f = l[i].split(\";\");\n              // Value to Text\n              if (!isRange && f.length == 2) {\n                _input._controller.panel.valueMaps.push({value: f[0], op: '=', text: f[1]});\n              }\n              // Range to Text\n              else if (isRange && f.length == 3) {\n                _input._controller.panel.rangeMaps.push({from: f[0], to: f[1], text: f[2]});\n              }\n            }\n          };\n        })(f, this);\n        // In case of abort from user action, remove previous data\n        this._reader.onabort = (function(_input) {\n          return function(e) {\n              document.getElementById(\"import-loading\").setAttribute(\"style\",\"display: none;\");\n              document.getElementById(\"import-button\").setAttribute(\"style\",\"display: inline-block;\");\n              document.getElementById(\"cancel-import-button\").setAttribute(\"style\",\"display: none;\");\n              _input._controller.$scope.$apply();\n              _input._controller.render();\n              _input.remove();\n          };\n        })(this);\n        // Once finished csv file processing, remove temporary input element\n        this._reader.onloadend = (function(_input) { \n          return function(e) {\n            if (e.target.readyState == FileReader.DONE) {\n              setTimeout(function(obj) {\n                document.getElementById(\"import-loading\").setAttribute(\"style\",\"display: none;\");\n                document.getElementById(\"import-button\").setAttribute(\"style\",\"display: inline-block;\");\n                document.getElementById(\"cancel-import-button\").setAttribute(\"style\",\"display: none;\");\n                obj._controller.$scope.$apply();\n                obj._controller.render();\n                obj.remove();\n              }, 3000, _input);\n            }\n          };\n        })(this);\n        // Read csv file as text (utf-8)\n        this._reader.readAsText(f);\n      }\n    }, false);\n    this.importContainer.click();\n  }\n\n  handle_click_event(el, evt, value) {\n    if (this.panel.clickable && this.panel.cevents.length == 1) {\n      var info = this.linkSrv.getPanelLinkAnchorInfo(this.panel.cevents[0], this.panel.scopedVars);\n      info.href = this.replaceAll(info.href, \"{{value}}\", value);\n      window.open(info.href, (info.target != \"\")?info.target:\"_self\");\n    } else if (this.panel.clickable && this.panel.cevents.length > 1) {\n      var $panelContainer = $(el).parents(\".panel-container\");\n      var $menu = null;\n      var menuScope = null;\n      var teather = null;\n      var timeout = null;\n\n      if (!$.contains(document, evt.target)) {\n       return;\n      }\n\n      if ($menu) {\n        this.event_panel_dismiss($menu, $panelContainer, menuScope, teather, timeout);\n        return;\n      }\n\n      var template = '<div class=\"panel-menu small\">';\n      template += '<div class=\"panel-menu-row\">';\n      _.each(this.panel.cevents, function(link) {\n        var info = this.linkSrv.getPanelLinkAnchorInfo(link, this.panel.scopedVars); \n        info.href = this.replaceAll(info.href, \"{{value}}\", value);\n        template += '<a class=\"panel-menu-link\" href=\"' + info.href + '\" target=\"' + info.target + '\">' + info.title + '</a>';\n      });\n\n      $menu = $(template);\n      $menu.mouseleave(function() {\n        this.event_panel_dismiss($menu, $panelContainer, menuScope, teather, timeout, 1000);\n      });\n      menuScope = this.$scope.$new();\n      menuScope.extendedMenu = this.getExtendedMenu();\n      menuScope.dismiss = function() {\n        this.event_panel_dismiss($menu, $panelContainer, menuScope, teather, timeout, null, true);\n      };\n      $(\".panel-container\").removeClass('panel-highlight');\n      $panelContainer.toggleClass('panel-highlight');\n      $('.panel-menu').remove();\n      $(el).append($menu);\n      this.$scope.$apply(function() {\n        this.$compile($menu.contents())(menuScope);\n        teather = new Tether({\n          element: $menu,\n          target: $panelContainer,\n          attachment: 'bottom center',\n          targetAttachment: 'top center',\n          constraints: [{\n\t    to: 'window',\n\t    attachment: 'together',\n\t    pin: true\n          }]\n        });\n      });\n      this.event_panel_dismiss($menu, $panelContainer, menuScope, teather, timeout, 2200);\n    }\n  }\n\n  event_panel_dismiss($menu, $panelContainer, menuScope, teather, timeout, time, force) {\n    clearTimeout(timeout);\n    timeout = null;\n\n    if (time) {\n      timeout = setTimeout(function() {\n        this.event_panel_dismiss($menu, $panelContainer, menuScope, teather, timeout);\n      }, time);\n      return;\n    }\n\n    // if hovering or draging pospone close\n    if (force !== true) {\n      if ($menu.is(':hover') || this.$scope.ctrl.dashboard.$$panelDragging) {\n        this.event_panel_dismiss($menu, $panelContainer, menuScope, teather, timeout, 2200);\n        return;\n      }\n    }\n\n    if (menuScope) {\n      teather.destroy();\n      $menu.unbind();\n      $menu.remove();\n      menuScope.$destroy();\n      menuScope = null;\n      $menu = null;\n      $panelContainer.removeClass('panel-highlight');\n    }\n  }\n\n  toggleMappingHelp(index) {\n    if (this.panel.mappingHelpIndex === index) {\n      this.panel.mappingHelpIndex = null;\n      return;\n    }\n    this.panel.mappingHelpIndex = index;\n  }\n\n  replaceAll(str, find, replace) {\n    var escaped = function(f) {\n      return f.replace(/([.*+?^=!:${}()|\\[\\]\\/\\\\])/g, \"\\\\$1\");\n    };\n\n    return str.replace(new RegExp(escaped(find), 'g'), replace);\n  }\n}\n\nPieChartCtrl.templateUrl = 'module.html';\n"]}